openapi: 3.0.3
info:
  title: Student API
  version: 1.0.0
servers:
  - url: https://example.edu/api

components:
  securitySchemes:
    CognitoOAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: "https://ap-southeast-2vpcce3wuu.auth.ap-southeast-2.amazoncognito.com/oauth2/authorize"
          tokenUrl:         "https://ap-southeast-2vpcce3wuu.auth.ap-southeast-2.amazoncognito.com/oauth2/token"
          scopes:
            students.read:  "Read student data"
            students.write: "Create/modify student data"

# 全域預設：大多數端點至少要 read
security:
  - CognitoOAuth2: [students.read]

paths:
  /health:
    get:
      summary: Health check
      security: []   # 匿名端點
      responses:
        "200":
          description: OK

  /students:
    get:
      summary: List students
      responses:
        "200":
          description: OK

    post:
      summary: Create student
      # 覆寫：寫入端點要 write
      security:
        - CognitoOAuth2: [students.write]
      responses:
        "201":
          description: Created
